{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}
<!-- Contact Hero -->
<section class="contact-hero bg-dark text-white py-2 position-relative overflow-hidden">
    <div class="hero-overlay"></div>
    <div class="container py-5 position-relative">
        <div class="row">
            <div class="col-lg-8 mx-auto text-center">
                <h1 class="display-4 fw-bold mb-4 animate__animated animate__fadeInDown">Contact Us</h1>
                <p class="lead animate__animated animate__fadeIn animate__delay-1s">We'd love to hear from you</p>
            </div>
        </div>
    </div>
</section>

<!-- Contact Form -->
<section class="py-5" id="contact-form-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 mb-5 mb-lg-0">
                <div class="form-container glow-card p-4 p-lg-5 rounded-4">
                    <h2 class="fw-bold mb-4">Send Us a Message</h2>
                    <form method="post" action="{% url 'studio:contact' %}" id="contactForm" class="needs-validation" novalidate>
                        {% csrf_token %}
                        {{ form|crispy }}
                        <div class="form-group mt-4">
                            <button type="submit" class="btn btn-primary hover-scale btn-glow">
                                <span class="submit-text">Send Message</span>
                                <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                            </button>
                        </div>
                        <div id="formSuccess" class="alert alert-success mt-3 d-none">
                            <i class="fas fa-check-circle me-2"></i> Your message has been sent successfully!
                        </div>
                        <div id="formError" class="alert alert-danger mt-3 d-none">
                            <i class="fas fa-exclamation-circle me-2"></i> There was an error sending your message. Please try again.
                        </div>
                    </form>
                </div>
            </div>
            <div class="col-lg-6">
                <h2 class="fw-bold mb-4">Contact Information</h2>
                <div class="card border-0 shadow-sm hover-lift">
                    <div class="card-body">
                        <div class="d-flex mb-4 contact-item">
                            <div class="icon-box bg-primary bg-opacity-10 text-primary rounded-circle me-4 hover-grow" style="width: 50px; height: 50px; line-height: 50px;" align="center">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div>
                                <h5 class="mb-1">Address</h5>
                                <p class="text-muted mb-0">Located Along Kenya Builders Road Honey Suckle Phase 3 Opposite Sela Care Health Care</p>
                            </div>
                        </div>
                        <div class="d-flex mb-4 contact-item">
                            <div class="icon-box bg-primary bg-opacity-10 text-primary rounded-circle me-4 hover-grow" align="center" style="width: 50px; height: 50px; line-height: 50px;">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div>
                                <h5 class="mb-1">Phone</h5>
                                <p class="text-muted mb-0"><a href="https://wa.me/+254799620033" class="text-reset">+254799620033</a></p>
                            </div>
                        </div>
                       <div class="d-flex contact-item">
                         <div class="icon-box bg-primary bg-opacity-10 text-primary rounded-circle me-4 hover-grow" align="center" style="width: 50px; height: 50px; line-height: 50px;">
                          <i class="fas fa-envelope"></i>
                             </div>
                      <div>
                          <h5 class="mb-1">Email</h5>
                       <p class="text-muted mb-0"><a href="mailto:mivlensstudio@gmail.com" class="text-reset">mivlensstudio@gmail.com</a></p>
                        </div>
                         </div>
                    </div>
                </div>
                
                <div class="card border-0 shadow-sm mt-4 hover-lift">
                    <div class="card-body">
                        <h5 class="mb-3">Studio Hours</h5>
                        <ul class="list-unstyled">
                            <li class="d-flex justify-content-between py-2 border-bottom hover-highlight">
                                <span class="text-muted">Monday - Sunday</span>
                                <span>8:00 AM - 6:00 PM</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Map -->
<section class="py-0 map-section">
    <div class="container-fluid p-0">
        <div class="map-overlay" onclick="this.style.pointerEvents='none'"></div>
        <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15955.154547089262!2d36.8851022!3d-1.316765!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x182f13fb4058eabf%3A0x57b0c36ab99694b3!2sSELACAREHEALTHSERVICES!5e0!3m2!1sen!2ske!4v1720000000000!5m2!1sen!2ske" 
            width="100%" 
            height="450" 
            style="border:0;" 
            allowfullscreen="" 
            loading="lazy" 
            referrerpolicy="no-referrer-when-downgrade"
            class="map-iframe">
        </iframe>
    </div>

    <!-- Directions Buttons -->
    <div class="text-center my-4">
        <p><strong>Get Directions from Your Location</strong></p>
        <a href="https://www.google.com/maps/dir/?api=1&destination=SELACAREHEALTHSERVICES,+Pipeline,+Quarry+Road,+Nairobi,+Kenya&travelmode=driving" 
           target="_blank" class="btn btn-success m-1">ðŸš— Driving</a>

        <a href="https://www.google.com/maps/dir/?api=1&destination=SELACAREHEALTHSERVICES,+Pipeline,+Quarry+Road,+Nairobi,+Kenya&travelmode=walking" 
           target="_blank" class="btn btn-secondary m-1">ðŸš¶ Walking</a>

        <a href="https://www.google.com/maps/dir/?api=1&destination=SELACAREHEALTHSERVICES,+Pipeline,+Quarry+Road,+Nairobi,+Kenya&travelmode=transit" 
           target="_blank" class="btn btn-info m-1">ðŸšŒ Public Transport</a>

        <a href="https://www.google.com/maps/dir/?api=1&destination=SELACAREHEALTHSERVICES,+Pipeline,+Quarry+Road,+Nairobi,+Kenya&travelmode=bicycling" 
           target="_blank" class="btn btn-warning m-1">ðŸš´ Cycling</a>
    </div>
</section>



{% endblock %}

{% block extra_js %}
<!-- Add Animate.css for animations -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
<!-- Add Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

<style>
    /* Custom CSS for transitions and effects */
    :root {
        --primary-color: #6a11cb;
        --secondary-color: #2b59a8;
        --accent-color: #ff4d4d;
        --glow-color: rgba(106, 17, 203, 0.4);
    }
    
    /* Gradient background for hero section */
    .contact-hero {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    }
    
    .hero-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 0%, transparent 50%);
        z-index: 0;
    }
    
    .contact-hero .container {
        z-index: 1;
    }
    
    /* Glowing form container */
    .form-container {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        transition: all 0.3s ease;
    }
    
    .glow-card {
        position: relative;
        overflow: hidden;
    }
    
    .glow-card::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(
            to bottom right,
            rgba(106, 17, 203, 0),
            rgba(106, 17, 203, 0),
            rgba(106, 17, 203, 0.3),
            rgba(106, 17, 203, 0)
        );
        transform: rotate(30deg);
        animation: glowAnimation 6s linear infinite;
        z-index: -1;
    }
    
    @keyframes glowAnimation {
        0% { transform: rotate(30deg) translate(-10%, -10%); }
        50% { transform: rotate(30deg) translate(10%, 10%); }
        100% { transform: rotate(30deg) translate(-10%, -10%); }
    }
    
    /* Button glow effect */
    .btn-glow {
        position: relative;
        overflow: hidden;
        z-index: 1;
    }
    
    .btn-glow::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, var(--primary-color), var(--secondary-color), var(--accent-color), var(--secondary-color), var(--primary-color));
        background-size: 400%;
        z-index: -1;
        filter: blur(5px);
        opacity: 0;
        transition: 0.5s;
    }
    
    .btn-glow:hover::before {
        opacity: 1;
        animation: btnGlow 8s linear infinite;
    }
    
    @keyframes btnGlow {
        0% { background-position: 0 0; }
        50% { background-position: 400% 0; }
        100% { background-position: 0 0; }
    }
    
    /* Hover effects */
    .hover-scale {
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .hover-scale:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .hover-lift {
        transition: all 0.3s ease;
    }
    .hover-lift:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.15) !important;
    }
    
    .hover-grow {
        transition: transform 0.3s ease;
    }
    .hover-grow:hover {
        transform: scale(1.1);
    }
    
    .hover-highlight {
        transition: all 0.2s ease;
    }
    .hover-highlight:hover {
        background-color: rgba(13, 110, 253, 0.05);
        padding-left: 10px;
        border-radius: 5px;
    }
    
    .contact-item {
        transition: all 0.3s ease;
        cursor: pointer;
    }
    
    .contact-item:hover {
        transform: translateX(5px);
    }
    
    /* Map overlay to prevent accidental dragging */
    .map-section {
        position: relative;
    }
    .map-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
        cursor: pointer;
        background: rgba(0,0,0,0.01);
        transition: all 0.3s ease;
    }
    
    .map-overlay:hover {
        background: rgba(0,0,0,0.03);
    }
    
    /* Animation for form section */
    .fade-in-section {
        opacity: 0;
        transition: opacity 1s ease, transform 1s ease;
        transform: translateY(20px);
    }
    .fade-in-section.is-visible {
        opacity: 1;
        transform: translateY(0);
    }
    
    /* Form validation styles */
    .was-validated .form-control:invalid,
    .form-control.is-invalid {
        border-color: #dc3545;
        padding-right: calc(1.5em + 0.75rem);
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right calc(0.375em + 0.1875rem) center;
        background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
    }
    
    .was-validated .form-control:valid,
    .form-control.is-valid {
        border-color: #198754;
        padding-right: calc(1.5em + 0.75rem);
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right calc(0.375em + 0.1875rem) center;
        background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
    }
    
    /* Floating animation for hero text */
    @keyframes float {
        0% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
        100% { transform: translateY(0px); }
    }
    
    .floating {
        animation: float 6s ease-in-out infinite;
    }
    
    /* Pulse animation for important elements */
    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
    
    .pulse {
        animation: pulse 4s ease infinite;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add intersection observer for scroll animations
        const contactSection = document.getElementById('contact-form-section');
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    
                    // Add pulse animation to form container
                    const formContainer = document.querySelector('.form-container');
                    if (formContainer) {
                        setTimeout(() => {
                            formContainer.classList.add('pulse');
                        }, 500);
                    }
                }
            });
        }, {
            threshold: 0.1
        });
        
        contactSection.classList.add('fade-in-section');
        observer.observe(contactSection);
        
        // Add floating animation to hero text
        const heroText = document.querySelector('.contact-hero h1');
        if (heroText) {
            heroText.classList.add('floating');
        }
        
        // Form submission handling
        const contactForm = document.getElementById('contactForm');
        if (contactForm) {
            contactForm.addEventListener('submit', function(e) {
                if (!this.checkValidity()) {
                    e.preventDefault();
                    e.stopPropagation();
                } else {
                    // Show loading spinner
                    const submitBtn = this.querySelector('button[type="submit"]');
                    const submitText = submitBtn.querySelector('.submit-text');
                    const spinner = submitBtn.querySelector('.spinner-border');
                    
                    submitText.textContent = 'Sending...';
                    spinner.classList.remove('d-none');
                    submitBtn.disabled = true;
                    
                    // Add glow effect during submission
                    submitBtn.classList.add('btn-glow-active');
                    
                    // In a real implementation, you would handle the form submission with AJAX
                    // This is just a simulation
                    setTimeout(function() {
                        // Hide spinner and show success message
                        spinner.classList.add('d-none');
                        submitText.textContent = 'Message Sent!';
                        
                        // Show success message
                        const successMsg = document.getElementById('formSuccess');
                        successMsg.classList.remove('d-none');
                        successMsg.classList.add('animate__animated', 'animate__fadeIn');
                        
                        // Reset form after 3 seconds
                        setTimeout(function() {
                            contactForm.reset();
                            submitText.textContent = 'Send Message';
                            submitBtn.disabled = false;
                            successMsg.classList.add('d-none');
                            successMsg.classList.remove('animate__animated', 'animate__fadeIn');
                        }, 3000);
                    }, 1500);
                }
                
                this.classList.add('was-validated');
            }, false);
        }
        
        // Make map interactive after first click
        const mapOverlay = document.querySelector('.map-overlay');
        if (mapOverlay) {
            mapOverlay.addEventListener('click', function() {
                this.style.opacity = '0';
                setTimeout(() => {
                    this.style.display = 'none';
                }, 300);
                document.querySelector('.map-iframe').style.pointerEvents = 'auto';
            });
        }
        
        // Add click animation to contact items
        const contactItems = document.querySelectorAll('.contact-item');
        contactItems.forEach(item => {
            item.addEventListener('click', function(e) {
                // Don't animate if clicking on a link
                if (e.target.tagName === 'A') return;
                
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 200);
            });
        });
        
        // Add hover effect to form container
        const formContainer = document.querySelector('.form-container');
        if (formContainer) {
            formContainer.addEventListener('mouseenter', function() {
                this.style.boxShadow = '0 15px 30px rgba(106, 17, 203, 0.2)';
            });
            
            formContainer.addEventListener('mouseleave', function() {
                this.style.boxShadow = '0 8px 32px 0 rgba(31, 38, 135, 0.15)';
            });
        }
    });
</script>
{% endblock %}