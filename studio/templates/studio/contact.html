{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}
<!-- Contact Hero -->
<section class="contact-hero bg-dark text-white py-5">
    <div class="container py-5">
        <div class="row">
            <div class="col-lg-8 mx-auto text-center">
                <h1 class="display-4 fw-bold mb-4 animate__animated animate__fadeInDown">Contact Us</h1>
                <p class="lead animate__animated animate__fadeIn animate__delay-1s">We'd love to hear from you</p>
            </div>
        </div>
    </div>
</section>

<!-- Contact Form -->
<section class="py-5" id="contact-form-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 mb-5 mb-lg-0">
                <h2 class="fw-bold mb-4">Send Us a Message</h2>
                <form method="post" action="{% url 'studio:contact' %}" id="contactForm" class="needs-validation" novalidate>
                    {% csrf_token %}
                    {{ form|crispy }}
                    <div class="form-group mt-4">
                        <button type="submit" class="btn btn-primary hover-scale">
                            <span class="submit-text">Send Message</span>
                            <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                        </button>
                    </div>
                    <div id="formSuccess" class="alert alert-success mt-3 d-none">
                        Your message has been sent successfully!
                    </div>
                    <div id="formError" class="alert alert-danger mt-3 d-none">
                        There was an error sending your message. Please try again.
                    </div>
                </form>
            </div>
            <div class="col-lg-6">
                <h2 class="fw-bold mb-4">Contact Information</h2>
                <div class="card border-0 shadow-sm hover-lift">
                    <div class="card-body">
                        <div class="d-flex mb-4 contact-item">
                            <div class="icon-box bg-primary bg-opacity-10 text-primary rounded-circle me-4 hover-grow" style="width: 50px; height: 50px; line-height: 50px;" align="center">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div>
                                <h5 class="mb-1">Address</h5>
                                <p class="text-muted mb-0">Embakasi, Nairobi, KENYA</p>
                            </div>
                        </div>
                        <div class="d-flex mb-4 contact-item">
                            <div class="icon-box bg-primary bg-opacity-10 text-primary rounded-circle me-4 hover-grow" align="center" style="width: 50px; height: 50px; line-height: 50px;">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div>
                                <h5 class="mb-1">Phone</h5>
                                <p class="text-muted mb-0"><a href="tel:+1234567890" class="text-reset">+254707249256</a></p>
                            </div>
                        </div>
                        <div class="d-flex contact-item">
                            <div class="icon-box bg-primary bg-opacity-10 text-primary rounded-circle me-4 hover-grow" align="center" style="width: 50px; height: 50px; line-height: 50px;">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div>
                                <h5 class="mb-1">Email</h5>
                                <p class="text-muted mb-0"><a href="mailto:info@photostudio.com" class="text-reset">info@photostudio.com</a></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card border-0 shadow-sm mt-4 hover-lift">
                    <div class="card-body">
                        <h5 class="mb-3">Studio Hours</h5>
                        <ul class="list-unstyled">
                            <li class="d-flex justify-content-between py-2 border-bottom hover-highlight">
                                <span class="text-muted">Monday - Friday</span>
                                <span>8:00 AM - 6:00 PM</span>
                            </li>
                            <li class="d-flex justify-content-between py-2 border-bottom hover-highlight">
                                <span class="text-muted">Saturday - Sunday</span>
                                <span>10:00 AM - 4:00 PM</span>
                            </li>
                            <!-- <li class="d-flex justify-content-between py-2 hover-highlight">
                                <span class="text-muted">Sunday</span>
                                <span>Closed</span>
                            </li> -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Map -->
<section class="py-0 map-section">
    <div class="container-fluid p-0">
        <div class="map-overlay" onclick="style.pointerEvents='none'"></div>
        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15955.193594543524!2d36.85433153071802!3d-1.3209516013276792!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x182f11e92f7c7e7f%3A0x1f54b11e2d8320ae!2sEmbakasi%2C%20Nairobi%2C%20Kenya!5e0!3m2!1sen!2sus!4v1656622331672!5m2!1sen!2sus"
        width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" class="map-iframe"></iframe>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<!-- Add Animate.css for animations -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

<style>
    /* Custom CSS for transitions and effects */
    .hover-scale {
        transition: transform 0.2s ease;
    }
    .hover-scale:hover {
        transform: scale(1.05);
    }
    
    .hover-lift {
        transition: all 0.3s ease;
    }
    .hover-lift:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
    }
    
    .hover-grow {
        transition: transform 0.3s ease;
    }
    .hover-grow:hover {
        transform: scale(1.1);
    }
    
    .hover-highlight {
        transition: all 0.2s ease;
    }
    .hover-highlight:hover {
        background-color: rgba(13, 110, 253, 0.05);
        padding-left: 10px;
        border-radius: 5px;
    }
    
    .contact-item {
        transition: all 0.3s ease;
    }
    
    /* Map overlay to prevent accidental dragging */
    .map-section {
        position: relative;
    }
    .map-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
        cursor: pointer;
    }
    
    /* Animation for form section */
    .fade-in-section {
        opacity: 0;
        transition: opacity 1s ease, transform 1s ease;
        transform: translateY(20px);
    }
    .fade-in-section.is-visible {
        opacity: 1;
        transform: translateY(0);
    }
    
    /* Form validation styles */
    .was-validated .form-control:invalid,
    .form-control.is-invalid {
        border-color: #dc3545;
        padding-right: calc(1.5em + 0.75rem);
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right calc(0.375em + 0.1875rem) center;
        background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
    }
    
    .was-validated .form-control:valid,
    .form-control.is-valid {
        border-color: #198754;
        padding-right: calc(1.5em + 0.75rem);
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right calc(0.375em + 0.1875rem) center;
        background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add intersection observer for scroll animations
        const contactSection = document.getElementById('contact-form-section');
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                }
            });
        }, {
            threshold: 0.1
        });
        
        contactSection.classList.add('fade-in-section');
        observer.observe(contactSection);
        
        // Form submission handling
        const contactForm = document.getElementById('contactForm');
        if (contactForm) {
            contactForm.addEventListener('submit', function(e) {
                if (!this.checkValidity()) {
                    e.preventDefault();
                    e.stopPropagation();
                } else {
                    // Show loading spinner
                    const submitBtn = this.querySelector('button[type="submit"]');
                    const submitText = submitBtn.querySelector('.submit-text');
                    const spinner = submitBtn.querySelector('.spinner-border');
                    
                    submitText.textContent = 'Sending...';
                    spinner.classList.remove('d-none');
                    submitBtn.disabled = true;
                    
                    // In a real implementation, you would handle the form submission with AJAX
                    // This is just a simulation
                    setTimeout(function() {
                        // Hide spinner and show success message
                        spinner.classList.add('d-none');
                        submitText.textContent = 'Message Sent!';
                        
                        // Show success message
                        document.getElementById('formSuccess').classList.remove('d-none');
                        
                        // Reset form after 3 seconds
                        setTimeout(function() {
                            contactForm.reset();
                            submitText.textContent = 'Send Message';
                            submitBtn.disabled = false;
                            document.getElementById('formSuccess').classList.add('d-none');
                        }, 3000);
                    }, 1500);
                }
                
                this.classList.add('was-validated');
            }, false);
        }
        
        // Make map interactive after first click
        const mapOverlay = document.querySelector('.map-overlay');
        if (mapOverlay) {
            mapOverlay.addEventListener('click', function() {
                this.style.display = 'none';
                document.querySelector('.map-iframe').style.pointerEvents = 'auto';
            });
        }
        
        // Add click animation to contact items
        const contactItems = document.querySelectorAll('.contact-item');
        contactItems.forEach(item => {
            item.addEventListener('click', function() {
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 200);
            });
        });
        
        // Copy email to clipboard
        const emailElement = document.querySelector('a[href^="mailto"]');
        if (emailElement) {
            emailElement.addEventListener('click', function(e) {
                e.preventDefault();
                const email = this.getAttribute('href').replace('mailto:', '');
                navigator.clipboard.writeText(email).then(() => {
                    const originalText = this.textContent;
                    this.textContent = 'Copied to clipboard!';
                    setTimeout(() => {
                        this.textContent = originalText;
                    }, 2000);
                });
            });
        }
    });
</script>
{% endblock %}